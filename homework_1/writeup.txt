Data exploration

  * labels
  * continuous
    * uniqueness of order id
    * distributions
    * collinearity
    * time -> normalization

  * categorical
    * even/balanced
  * missing values
  * new dummy or new predictors
  * sales channel predictors
    * item type
    * country
    * ?
    

* Models
  * KNN
    * assumptions
    * data prep
    * performance
    * improvements
  * Naive Bayes
    * assumptions
    * data prep
    * performance



Brief

This data set includes features for a ficticious global retail company that sells household products, presumably in stores and online. The continuous features describe financial cost and sales related metrics while the categorical features describe the company products and geographic data. Additionally, there are two time related features regarding sales orders as well.

I noticed the data set includes a binary category feature for sales channel (offline versus online), so I decided to see if the other features could predict if a product favored a particular channel, given its sales and geographic data. Even though the data set was artificially generated, I can easily see where an operations director needs to know if more sales occurred for a given product, region and time. 

However, after trying out a few different models, I concluded the current data set cannot reliably predict the sales channel with the best performance coming from an KNN model with an accuracy rate of 58% and other models less than 53%.

Data Set Exploration

The data set labels are below:

"Region"         "Country"        "Item Type"      "Sales Channel"  "Order Priority"
"Order Date"     "Order ID"       "Ship Date"      "Units Sold"     "Unit Price"    
"Unit Cost"      "Total Revenue"  "Total Cost"     "Total Profit"   

Again, each row describe product sales and profit in a particular market and time. For the categorical features, I assume there are no data integrity issues such as the same region, country or item appearing more than once under two different spellings due to data input errors. I later spot check these fields to confirm.

Judging from the labels for the continuous features, there are natural groups that instantly appear:
 * Units - sold, price and cost
 * Total - revenue, cost, profit
 * Date - order, ship

We'll explore further the relationships between these variables.

The only continous feature that isn't in a group is the order ID as it's presumably a meta data field assigned to identify a row and not recorded by sales.


### Uniqueness of Order ID

Presumably, the order ID is autogenerated and unique but I confirm it below



### Distributions of Continuous Variables

The continuous variables have either a normal or poisson distribution. The only exceptions are the order ID and unit price and cost variables. The order ID doesn't seem to have any real shape so it's difficult to tell without more data.

The unit price and cost suffer from not having enough data as well.

### Collinearity

Checking for collinear variables shows a strong relationship (0.8 - 1) between the pricing, cost and date features. The variables have positive collinearity (0.2 - 0.4). I can start using all of the variables in models and consider taking one of each group out to see if performance improves.


### Time normalization

For the date fields, they came in a non-standard field but I transformed them into DateTime objects. Thinking about different objects, I normalized them as a numeric field that measures days from an arbitrary date (e.g. 2000-01-01). This was one of the requirements for the KNN model.


### Scatter Plot

The scatter plot matrix shows how there are positive linear relationships between some continuous variables:

  * Units sold - total revenue, total cost, total profit
  * Unit price - units cost

Only the Order ID shows no relationship with any other variable.

For the first group, there are linear relationships with positive slopes, e.g. total revenus to units sold. After checking for normal linear regression assumptions, we find violations...


For date time variables, scatter plots of them versus some of the other variables confirmed there was no relationship (e.g. with units sold or total revenue).



### Missing values

From the data set summary, we see no missing values for any variables. If there were, we would have to try to impute values as to not diverge from the feature medians.

### New Feature
The only new feature created was from the two date time objects:  a diff_time between the ship and order date.

### Date Time normalization
At least one model (KNN), requires all continous variables to be normalized. So, for the date time features, the number of days from an 'epoch' date was calculated.

### Balanced classes for Sales channel

Checking both the original and sample sets, similar ratios of online versus offline sales was maintained.

Also, for the country category, all countries should be represented to avoid an error in the prediction ('cannot predict for rows with new country'). The code below specifically moves rows from the test set to the training set for new countries.

